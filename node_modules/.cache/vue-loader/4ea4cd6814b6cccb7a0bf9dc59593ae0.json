{"remainingRequest":"/home/tarena/yuying/Learning/Vue3/Vue-Project/mall/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/tarena/yuying/Learning/Vue3/Vue-Project/mall/src/views/Category/Category.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/tarena/yuying/Learning/Vue3/Vue-Project/mall/src/views/Category/Category.vue","mtime":1622267426000},{"path":"/home/tarena/yuying/Learning/Vue3/Vue-Project/mall/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/tarena/yuying/Learning/Vue3/Vue-Project/mall/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/tarena/yuying/Learning/Vue3/Vue-Project/mall/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/tarena/yuying/Learning/Vue3/Vue-Project/mall/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgTmF2QmFyIGZyb20gJ2NvbXBvbmVudHMvY29tbW9uL25hdmJhci9OYXZCYXInDQppbXBvcnQgQ2F0ZWdvcnlNZW51IGZyb20gJy4vY2hpbGRDb3Btcy9DYXRlZ29yeU1lbnUnDQppbXBvcnQgTWVudURldGFpbCBmcm9tICcuL2NoaWxkQ29wbXMvTWVudURldGFpbCcNCmltcG9ydCBDb250ZW50RGV0YWlsIGZyb20gJy4vY2hpbGRDb3Btcy9Db250ZW50RGV0YWlsJw0KaW1wb3J0IFNjcm9sbCBmcm9tICdjb21wb25lbnRzL2NvbW1vbi9zY3JvbGwvU2Nyb2xsJw0KaW1wb3J0IFRhYkNvbnRyb2wgZnJvbSAnY29tcG9uZW50cy9jb250ZW50L3RhYkNvbnRyb2wvVGFiQ29udHJvbCcNCg0KaW1wb3J0IHtnZXRDYXRlZ29yeSxnZXRzdWJjYXRlZ29yeSxnZXRDb250ZW50RGV0YWlsfSBmcm9tICduZXR3b3JrL2NhdGVnb3J5LmpzJw0KaW1wb3J0IHtiYWNrVG9wTWl4aW59IGZyb20gJ2NvbW1vbi9taXhpbi5qcycNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogJ0NhdGVnb3J5JywNCiAgY29tcG9uZW50czogew0KICAgIE5hdkJhciwNCiAgICBDYXRlZ29yeU1lbnUsDQogICAgTWVudURldGFpbCwNCiAgICBDb250ZW50RGV0YWlsLA0KICAgIFNjcm9sbCwNCiAgICBUYWJDb250cm9sDQogIH0sDQogIGRhdGEoKXsNCiAgICAgIHJldHVybiB7DQogICAgICAgIGNhdGVnb3JpZXM6IFtdLA0KICAgICAgICBjYXRlZ29yeURhdGE6IFtdLA0KICAgICAgICBjdXJyZW50SW5kZXg6IC0xLA0KICAgICAgICBjdXJyZW50VHlwZTogJ3BvcCcNCiAgICAgIH0NCiAgfSwNCiAgbWl4aW5zOiBbYmFja1RvcE1peGluXSwNCiAgY3JlYXRlZCAoKSB7DQogICAgdGhpcy5fZ2V0Q2F0ZWdvcnkoKQ0KICAgIC8vIHRoaXMuX2dldHViY2F0ZWdvcnkoMCkNCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICBzaG93U3ViY2F0ZWdvcnkgKCkgew0KICAgICAgaWYodGhpcy5jdXJyZW50SW5kZXggPT09IC0xKSByZXR1cm4ge30NCiAgICAgIHJldHVybiB0aGlzLmNhdGVnb3J5RGF0YVt0aGlzLmN1cnJlbnRJbmRleF0uc3ViY2F0ZWdvcmllcw0KICAgIH0sDQogICAgc2hvd0NvbnRlbnREZXRhaWwgKCkgew0KICAgICAgaWYodGhpcy5jdXJyZW50SW5kZXggPT09IC0xKSByZXR1cm4gW10NCiAgICAgIHJldHVybiB0aGlzLmNhdGVnb3J5RGF0YVt0aGlzLmN1cnJlbnRJbmRleF0uY2F0ZWdvcnlEZXRhaWxbDQogICAgICAgIHRoaXMuY3VycmVudFR5cGUNCiAgICAgIF0NCiAgICB9DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBfZ2V0Q2F0ZWdvcnkoKXsNCiAgICAgIGdldENhdGVnb3J5KCkudGhlbihyZXMgPT4gew0KICAgICAgY29uc29sZS5sb2cocmVzKTsNCiAgICAgIC8vIDEu6I635Y+W5YiG57G75pWw5o2uDQogICAgICB0aGlzLmNhdGVnb3JpZXMgPSByZXMuZGF0YS5jYXRlZ29yeS5saXN0DQogICAgICAvLyAyLuWIneWni+WMluavj+S4quexu+WIq+eahOWtkOaVsOaNrg0KICAgICAgZm9yKGxldCBpPTA7IGk8dGhpcy5jYXRlZ29yaWVzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgIHRoaXMuY2F0ZWdvcnlEYXRhW2ldID0gew0KICAgICAgICAgIHN1YmNhdGVnb3JpZXM6IHt9LA0KICAgICAgICAgIGNhdGVnb3J5RGV0YWlsOiB7DQogICAgICAgICAgICAncG9wJzogW10sDQogICAgICAgICAgICAnbmV3JzogW10sDQogICAgICAgICAgICAnc2VsbCc6IFtdDQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICB9DQogICAgLy8gICDkuLvmlbDmja7or7fmsYLliLDkuYvlkI7miY3og73mjqXnnYDor7fmsYLlkI7pnaLnmoTlrZDmlbDmja4NCiAgICAgIHRoaXMuX2dldHN1YmNhdGVnb3J5KDApDQogICAgfSkNCiAgICB9LA0KICAgIF9nZXRzdWJjYXRlZ29yeShpbmRleCl7DQogICAgICAgIHRoaXMuY3VycmVudEluZGV4ID0gaW5kZXgNCiAgICAgICAgY29uc3QgbWFpbEtleSA9IHRoaXMuY2F0ZWdvcmllc1tpbmRleF0ubWFpdEtleQ0KICAgICAgICBnZXRzdWJjYXRlZ29yeShtYWlsS2V5KS50aGVuKHJlcyA9PiB7DQogICAgICAgICAgY29uc29sZS5sb2cocmVzKTsNCiAgICAgICAgICB0aGlzLmNhdGVnb3J5RGF0YVtpbmRleF0uc3ViY2F0ZWdvcmllcyA9IHJlcy5kYXRhDQogICAgICAgICAgdGhpcy5jYXRlZ29yeURhdGEgPSB7Li4udGhpcy5jYXRlZ29yeURhdGF9DQogICAgICAgICAgdGhpcy5fZ2V0Q29udGVudERldGFpbCgncG9wJykNCiAgICAgICAgICB0aGlzLl9nZXRDb250ZW50RGV0YWlsKCduZXcnKQ0KICAgICAgICAgIHRoaXMuX2dldENvbnRlbnREZXRhaWwoJ3NlbGwnKQ0KICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMuY2F0ZWdvcnlEYXRhKTsNCiAgICB9KQ0KICAgIH0sDQogICAgX2dldENvbnRlbnREZXRhaWwodHlwZSkgew0KICAgICAgY29uc3QgbWluaVdhbGxrZXkgPSB0aGlzLmNhdGVnb3JpZXNbdGhpcy5jdXJyZW50SW5kZXhdLm1pbmlXYWxsa2V5Ow0KICAgICAgY29uc29sZS5sb2cobWluaVdhbGxrZXkpOw0KICAgICAgZ2V0Q29udGVudERldGFpbChtaW5pV2FsbGtleSwgdHlwZSkudGhlbihyZXMgPT4gew0KICAgICAgICAgIHRoaXMuY2F0ZWdvcnlEYXRhW3RoaXMuY3VycmVudEluZGV4XS5jYXRlZ29yeURldGFpbFt0eXBlXSA9IHJlcw0KICAgICAgICAgIHRoaXMuY2F0ZWdvcnlEYXRhID0gey4uLnRoaXMuY2F0ZWdvcnlEYXRhfQ0KICAgICAgICB9KQ0KICAgIH0sDQogICAgdGFiQ2xpY2sgKGluZGV4KSB7DQogICAgICBzd2l0Y2ggKGluZGV4KSB7DQogICAgICAgIGNhc2UgMDoNCiAgICAgICAgICB0aGlzLmN1cnJlbnRUeXBlID0gJ3BvcCcNCiAgICAgICAgICBicmVhaw0KICAgICAgICBjYXNlIDE6DQogICAgICAgICAgdGhpcy5jdXJyZW50VHlwZSA9ICduZXcnDQogICAgICAgICAgYnJlYWsNCiAgICAgICAgY2FzZSAyOg0KICAgICAgICAgIHRoaXMuY3VycmVudFR5cGUgPSAnc2VsbCcNCiAgICAgICAgICBicmVhaw0KICAgICAgfQ0KICAgICAgY29uc29sZS5sb2codGhpcy5jdXJyZW50VHlwZSk7DQogICAgfSwNCiAgICBzZWxlY3RJdGVtIChpbmRleCkgew0KICAgICAgdGhpcy5fZ2V0c3ViY2F0ZWdvcnkoaW5kZXgpDQogICAgfSwNCiAgICBzY3JvbGwgKHBvc2l0aW9uKSB7DQogICAgICBjb25zdCBwb3NpdGlvblkgPSAtcG9zaXRpb24ueQ0KICAgICAgLy8gY29uc29sZS5sb2cocG9zaXRpb25ZKTsNCiAgICAgIHRoaXMuc2hvd1RvcCA9IHBvc2l0aW9uWSA+IDEwMDANCiAgICB9DQogIH0NCn0NCg=="},{"version":3,"sources":["Category.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAyBA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Category.vue","sourceRoot":"src/views/Category","sourcesContent":["<template>\r\n    <div class=\"wrapper\">\r\n        <nav-bar class=\"nav-bar\">\r\n            <template #center>商品分类</template>\r\n        </nav-bar>\r\n        <div class=\"content\">\r\n          <category-menu :categories='categories' @selectItem='selectItem'/>\r\n          <scroll class=\"tab-content\" \r\n          :data='[categoryData]' \r\n          ref=\"scroll\"\r\n          :probe-type='3'\r\n          @scroll=\"scroll\">\r\n          <div>\r\n            <menu-detail :subcategories='showSubcategory'/>\r\n            <tab-control :titles=\"['综合','新品','销量']\" \r\n            @tabClick='tabClick'/>\r\n            <content-detail :content-detail='showContentDetail'/>\r\n          </div>\r\n        </scroll>\r\n        </div>\r\n        <back-top v-show=\"showTop\" @click.native=\"backTop\"></back-top>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport NavBar from 'components/common/navbar/NavBar'\r\nimport CategoryMenu from './childCopms/CategoryMenu'\r\nimport MenuDetail from './childCopms/MenuDetail'\r\nimport ContentDetail from './childCopms/ContentDetail'\r\nimport Scroll from 'components/common/scroll/Scroll'\r\nimport TabControl from 'components/content/tabControl/TabControl'\r\n\r\nimport {getCategory,getsubcategory,getContentDetail} from 'network/category.js'\r\nimport {backTopMixin} from 'common/mixin.js'\r\nexport default {\r\n  name: 'Category',\r\n  components: {\r\n    NavBar,\r\n    CategoryMenu,\r\n    MenuDetail,\r\n    ContentDetail,\r\n    Scroll,\r\n    TabControl\r\n  },\r\n  data(){\r\n      return {\r\n        categories: [],\r\n        categoryData: [],\r\n        currentIndex: -1,\r\n        currentType: 'pop'\r\n      }\r\n  },\r\n  mixins: [backTopMixin],\r\n  created () {\r\n    this._getCategory()\r\n    // this._getubcategory(0)\r\n  },\r\n  computed: {\r\n    showSubcategory () {\r\n      if(this.currentIndex === -1) return {}\r\n      return this.categoryData[this.currentIndex].subcategories\r\n    },\r\n    showContentDetail () {\r\n      if(this.currentIndex === -1) return []\r\n      return this.categoryData[this.currentIndex].categoryDetail[\r\n        this.currentType\r\n      ]\r\n    }\r\n  },\r\n  methods: {\r\n    _getCategory(){\r\n      getCategory().then(res => {\r\n      console.log(res);\r\n      // 1.获取分类数据\r\n      this.categories = res.data.category.list\r\n      // 2.初始化每个类别的子数据\r\n      for(let i=0; i<this.categories.length; i++) {\r\n        this.categoryData[i] = {\r\n          subcategories: {},\r\n          categoryDetail: {\r\n            'pop': [],\r\n            'new': [],\r\n            'sell': []\r\n          }\r\n        }\r\n      }\r\n    //   主数据请求到之后才能接着请求后面的子数据\r\n      this._getsubcategory(0)\r\n    })\r\n    },\r\n    _getsubcategory(index){\r\n        this.currentIndex = index\r\n        const mailKey = this.categories[index].maitKey\r\n        getsubcategory(mailKey).then(res => {\r\n          console.log(res);\r\n          this.categoryData[index].subcategories = res.data\r\n          this.categoryData = {...this.categoryData}\r\n          this._getContentDetail('pop')\r\n          this._getContentDetail('new')\r\n          this._getContentDetail('sell')\r\n          console.log(this.categoryData);\r\n    })\r\n    },\r\n    _getContentDetail(type) {\r\n      const miniWallkey = this.categories[this.currentIndex].miniWallkey;\r\n      console.log(miniWallkey);\r\n      getContentDetail(miniWallkey, type).then(res => {\r\n          this.categoryData[this.currentIndex].categoryDetail[type] = res\r\n          this.categoryData = {...this.categoryData}\r\n        })\r\n    },\r\n    tabClick (index) {\r\n      switch (index) {\r\n        case 0:\r\n          this.currentType = 'pop'\r\n          break\r\n        case 1:\r\n          this.currentType = 'new'\r\n          break\r\n        case 2:\r\n          this.currentType = 'sell'\r\n          break\r\n      }\r\n      console.log(this.currentType);\r\n    },\r\n    selectItem (index) {\r\n      this._getsubcategory(index)\r\n    },\r\n    scroll (position) {\r\n      const positionY = -position.y\r\n      // console.log(positionY);\r\n      this.showTop = positionY > 1000\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.wrapper {\r\n    /* background: chartreuse; */\r\n    height: 100vh;\r\n}\r\n.nav-bar {\r\n    background: var(--color-tint);\r\n    color: #fff;\r\n    font-weight: 700;\r\n}\r\n.content {\r\n  overflow: hidden;\r\n  position: absolute;\r\n  left: 0;\r\n  right: 0;\r\n  top: 44px;\r\n  bottom: 49px;\r\n  display: flex;\r\n}\r\n.tab-content {\r\n  height: 100%;\r\n  flex: 1;\r\n  position: absolute;\r\n  left: 100px;\r\n}\r\n</style>\r\n"]}]}