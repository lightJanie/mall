{"remainingRequest":"/home/tarena/code/Vue3/Vue-Project/mall/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/tarena/code/Vue3/Vue-Project/mall/src/views/Category/Category.vue?vue&type=style&index=0&id=f224a676&scoped=true&lang=css&","dependencies":[{"path":"/home/tarena/code/Vue3/Vue-Project/mall/src/views/Category/Category.vue","mtime":1622267426000},{"path":"/home/tarena/code/Vue3/Vue-Project/mall/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/tarena/code/Vue3/Vue-Project/mall/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/tarena/code/Vue3/Vue-Project/mall/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/tarena/code/Vue3/Vue-Project/mall/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/tarena/code/Vue3/Vue-Project/mall/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi53cmFwcGVyIHsNCiAgICAvKiBiYWNrZ3JvdW5kOiBjaGFydHJldXNlOyAqLw0KICAgIGhlaWdodDogMTAwdmg7DQp9DQoubmF2LWJhciB7DQogICAgYmFja2dyb3VuZDogdmFyKC0tY29sb3ItdGludCk7DQogICAgY29sb3I6ICNmZmY7DQogICAgZm9udC13ZWlnaHQ6IDcwMDsNCn0NCi5jb250ZW50IHsNCiAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgcG9zaXRpb246IGFic29sdXRlOw0KICBsZWZ0OiAwOw0KICByaWdodDogMDsNCiAgdG9wOiA0NHB4Ow0KICBib3R0b206IDQ5cHg7DQogIGRpc3BsYXk6IGZsZXg7DQp9DQoudGFiLWNvbnRlbnQgew0KICBoZWlnaHQ6IDEwMCU7DQogIGZsZXg6IDE7DQogIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgbGVmdDogMTAwcHg7DQp9DQo="},{"version":3,"sources":["Category.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Category.vue","sourceRoot":"src/views/Category","sourcesContent":["<template>\r\n    <div class=\"wrapper\">\r\n        <nav-bar class=\"nav-bar\">\r\n            <template #center>商品分类</template>\r\n        </nav-bar>\r\n        <div class=\"content\">\r\n          <category-menu :categories='categories' @selectItem='selectItem'/>\r\n          <scroll class=\"tab-content\" \r\n          :data='[categoryData]' \r\n          ref=\"scroll\"\r\n          :probe-type='3'\r\n          @scroll=\"scroll\">\r\n          <div>\r\n            <menu-detail :subcategories='showSubcategory'/>\r\n            <tab-control :titles=\"['综合','新品','销量']\" \r\n            @tabClick='tabClick'/>\r\n            <content-detail :content-detail='showContentDetail'/>\r\n          </div>\r\n        </scroll>\r\n        </div>\r\n        <back-top v-show=\"showTop\" @click.native=\"backTop\"></back-top>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport NavBar from 'components/common/navbar/NavBar'\r\nimport CategoryMenu from './childCopms/CategoryMenu'\r\nimport MenuDetail from './childCopms/MenuDetail'\r\nimport ContentDetail from './childCopms/ContentDetail'\r\nimport Scroll from 'components/common/scroll/Scroll'\r\nimport TabControl from 'components/content/tabControl/TabControl'\r\n\r\nimport {getCategory,getsubcategory,getContentDetail} from 'network/category.js'\r\nimport {backTopMixin} from 'common/mixin.js'\r\nexport default {\r\n  name: 'Category',\r\n  components: {\r\n    NavBar,\r\n    CategoryMenu,\r\n    MenuDetail,\r\n    ContentDetail,\r\n    Scroll,\r\n    TabControl\r\n  },\r\n  data(){\r\n      return {\r\n        categories: [],\r\n        categoryData: [],\r\n        currentIndex: -1,\r\n        currentType: 'pop'\r\n      }\r\n  },\r\n  mixins: [backTopMixin],\r\n  created () {\r\n    this._getCategory()\r\n    // this._getubcategory(0)\r\n  },\r\n  computed: {\r\n    showSubcategory () {\r\n      if(this.currentIndex === -1) return {}\r\n      return this.categoryData[this.currentIndex].subcategories\r\n    },\r\n    showContentDetail () {\r\n      if(this.currentIndex === -1) return []\r\n      return this.categoryData[this.currentIndex].categoryDetail[\r\n        this.currentType\r\n      ]\r\n    }\r\n  },\r\n  methods: {\r\n    _getCategory(){\r\n      getCategory().then(res => {\r\n      console.log(res);\r\n      // 1.获取分类数据\r\n      this.categories = res.data.category.list\r\n      // 2.初始化每个类别的子数据\r\n      for(let i=0; i<this.categories.length; i++) {\r\n        this.categoryData[i] = {\r\n          subcategories: {},\r\n          categoryDetail: {\r\n            'pop': [],\r\n            'new': [],\r\n            'sell': []\r\n          }\r\n        }\r\n      }\r\n    //   主数据请求到之后才能接着请求后面的子数据\r\n      this._getsubcategory(0)\r\n    })\r\n    },\r\n    _getsubcategory(index){\r\n        this.currentIndex = index\r\n        const mailKey = this.categories[index].maitKey\r\n        getsubcategory(mailKey).then(res => {\r\n          console.log(res);\r\n          this.categoryData[index].subcategories = res.data\r\n          this.categoryData = {...this.categoryData}\r\n          this._getContentDetail('pop')\r\n          this._getContentDetail('new')\r\n          this._getContentDetail('sell')\r\n          console.log(this.categoryData);\r\n    })\r\n    },\r\n    _getContentDetail(type) {\r\n      const miniWallkey = this.categories[this.currentIndex].miniWallkey;\r\n      console.log(miniWallkey);\r\n      getContentDetail(miniWallkey, type).then(res => {\r\n          this.categoryData[this.currentIndex].categoryDetail[type] = res\r\n          this.categoryData = {...this.categoryData}\r\n        })\r\n    },\r\n    tabClick (index) {\r\n      switch (index) {\r\n        case 0:\r\n          this.currentType = 'pop'\r\n          break\r\n        case 1:\r\n          this.currentType = 'new'\r\n          break\r\n        case 2:\r\n          this.currentType = 'sell'\r\n          break\r\n      }\r\n      console.log(this.currentType);\r\n    },\r\n    selectItem (index) {\r\n      this._getsubcategory(index)\r\n    },\r\n    scroll (position) {\r\n      const positionY = -position.y\r\n      // console.log(positionY);\r\n      this.showTop = positionY > 1000\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.wrapper {\r\n    /* background: chartreuse; */\r\n    height: 100vh;\r\n}\r\n.nav-bar {\r\n    background: var(--color-tint);\r\n    color: #fff;\r\n    font-weight: 700;\r\n}\r\n.content {\r\n  overflow: hidden;\r\n  position: absolute;\r\n  left: 0;\r\n  right: 0;\r\n  top: 44px;\r\n  bottom: 49px;\r\n  display: flex;\r\n}\r\n.tab-content {\r\n  height: 100%;\r\n  flex: 1;\r\n  position: absolute;\r\n  left: 100px;\r\n}\r\n</style>\r\n"]}]}